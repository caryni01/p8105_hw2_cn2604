---
title: "p8105_hw2_cn2604"
output: github_document
date: "2022-09-27"
---

```{r load_library,echo = FALSE, message=FALSE}
library(tidyverse)
```
# Problem 1
```{r read_file, echo=FALSE, message=FALSE}
transit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    entry = recode(entry, 'YES' = 'TRUE', 'NO' = 'FLASE'),
    entry = as.logical(entry),
    corner = as.factor(corner),
    staffing = as.factor(staffing),
    entrance_type = as.factor(entrance_type),
    division = as.factor(division),
    route8 = as.character(route8),
    route9 = as.character(route9),
    route10 = as.character(route10),
    route11 = as.character(route11)
  ) %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    names_prefix = "route",
    values_to = "route_name"
  ) %>% 
  unite(col = 'unique_station_name', c('station_name', 'line'), sep = ' ')
  
  
```
The primary variables of this dataset are the name and location of the stations, their divisions and lines with different routes, the types of entrance and their locations. Other additional information such as presence of staffs, vending, ADA, and crossing over are also provided.
My __cleaning steps__ are 
1) Read the csv documents and clean the names with janitor.
2) Convert _entry_ variable to logical variable, _corner_, _staffing_, _entrance_type_, and _division_ to factor variables, and convert _route8_ to _route11_ to character variables.
3) To make tidy data by separating the variables of _route_name_ and _route_number_ with pivot_longer function.
4) Combine the column of _station_name_ and _line_ to _unique_station_name_ as a mark the station.

This processed dataset has `r nrow(transit_df)` rows and `r ncol(transit_df)` columns. Since the variables of  _route_name_ and _route_number_ are manipulated to make each column a variable and each row an observation, data in this set are now tidy. 

```{r count_stations, echo=FALSE, message=FALSE}
station_number = n_distinct(transit_df$unique_station_name)
station_ada = n_distinct(transit_df$unique_station_name[transit_df$ada == TRUE])
total_no_vending = n_distinct(transit_df$unique_station_name[transit_df$vending == 'NO'])
no_vending_with_entrance = n_distinct(transit_df$unique_station_name[transit_df$vending == 'NO' & transit_df$entry == TRUE])
station_proportion = round(no_vending_with_entrance/total_no_vending, digits = 2)
```

There are `r station_number` unique stations and `r station_ada` of them are ADA compliant. `r station_proportion` is the proportion of stations that have no vending but allow entrance.
